<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>TheWordSearchGame</title>
    <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@400;700&display=swap" rel="stylesheet">
    <style>

        @keyframes backgroundAnimation {
            0% { background-position: 0% 50%; }
            50% { background-position: 100% 50%; }
            100% { background-position: 0% 50%; }
        }
        body {
            background: linear-gradient(270deg, #1a2a6c, #b21f1f, #fdbb2d);
            background-size: 600% 600%;
            animation: backgroundAnimation 10s ease infinite;
            font-family: 'Roboto', sans-serif;
            display: flex;
            justify-content: center;
            align-items: center;
            height: 100vh;
            margin: 0;
        }

        .content {
            text-align: center;
            position: relative;
        }

        .lobby-overlay {
            position: relative;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: #b1b1b1(0, 0, 0, 0.5);
            display: none;
            justify-content: center;
            z-index: 999;
        }

        .lobby-content {
            position: relative;
            background-color: #c4c4c4;
            padding: 20px;
            border-radius: 10px;
            text-align: center;
            width: 50%;
            height: 50%;
            margin: 10% auto;
        }
        

        .leaderboard-container {
            position: absolute;
            top: 10%;
            left: 3%;
            width: 15%;
            height: 80%;
            border-radius: 20px;
            background-color: #c4c4c4;
            padding: 10px;
            z-index: 999;
        }

        .leaderboard-content {
            position: absolute;
            float: left;
            top: 20%;
            left: 50px;
            border: 20px;
            background-color: #c4c4c4;
            padding: 5px;
            width: 100%;
            height: 100%;
        }

        .chat-container {
            position: absolute;
            top: 10%;
            right: 3%;
            width: 15%;
            height: 80%;
            border-radius: 20px;
            background-color: #c4c4c4;
            padding: 10px;

            z-index: 999;
        }

        .chat-content {
            position: relative;
            background-color: #c4c4c4;
            padding: 20px;
            border-radius: 10px;
            text-align: center;
            width: 50%;
            height: 50%;

            margin: 10% auto;
        }


        .contact-button {
            background-color: #349b69;
            position: absolute;
            top: 20%;
            right: 10%;
            width: 80%;
            padding: 5px 20px;
            border: none;
            background-color: #398aaa;
            color: white;
            font-size: 16px;
            border-radius: 20px;
            cursor: pointer;
        }

        .contact-button:hover {
            background-color: #349b69;
        }

        .selected-contact {
            background-color: #3b6e55;
        }

        .chat-container textarea {
        position: fixed;
        width: 14%;
        height: 18%;
        bottom: 15%; 
        right: 3.5%;
        padding: 10px;
        margin: 2px 0 15px 0;
        border: auto;
        border-radius: 20px;
        background: #c4c4c4;
        resize: none;
        max-height: 5%;
        }

        .chat-container textarea:focus {
        background-color: #ddd;
        outline: none;
        }
        
        .enter-button {
            padding: 10px 20px;
            border: none;
            background-color: #39aa73;
            color: white;
            font-size: 16px;
            border-radius: 20px;
            cursor: pointer;
        }

        .enter-button:hover {
            background-color: #349b69;
        }

        .button-container {
            position: relative;
            display: flex;
            z-index: 1000;
        }


        .back-button {
            position: absolute;
            top: 10px;
            left: 10px;
            padding: 10px 20px;
            border: none;
            background-color: #ff4d4d;
            color: white;
            font-size: 16px;
            border-radius: 20px;
            cursor: pointer;
            z-index: 1000;
        }

        .back-button:hover {
            background-color: #ff3e3e;
        }


        .room-button {
            padding: 5px 20px;
            border: none;
            margin: 10px;
            background-color: #39aa73;
            color: white;
            font-size: 16px;
            border-radius: 20px;
            cursor: pointer;
        }

        .room-button:hover {
            background-color: #349b69;
        }

        .chat-button {
            position: absolute;
            bottom: 5%;
            right: 10%;
            width: 80%;
            padding: 5px 20px;
            border: none;
            background-color: #398aaa;
            color: white;
            font-size: 16px;
            border-radius: 20px;
            cursor: pointer;
        }

        .chat-button:hover {
            background-color: #277ea1;
        }

        .readyup-overlay {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: #b1b1b1(0, 0, 0, 0.5);
            display: none;
            justify-content: center;
            align-items: center;
            z-index: 999;
        }

        .readyup-content {
            background-color: #c4c4c4;
            padding: 20px;
            border-radius: 10px;
            text-align: center;
        }

        .game-overlay {
            /* position: absolute; */
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: #b1b1b1(0, 0, 0, 0.5);
            display: none;
            justify-content: center;
            z-index: 999;
        }

        .game-content {
            position: relative;
            background-color: #c4c4c4;
            padding: 20px;
            border-radius: 10px;
            text-align: center;
            width: 80%;
            height: 80%;
            margin: 10% auto;
        }
    </style>
</head>

<!-- div stuff goes here (content that will actually get displayed) -->
<body>
    <div class="content">
        <h1>TheWordSearchGame</h1>

        <div id="wordGrid"></div>

        <label id="topMessage"></label>

        <p>Enter your user name</p>

        <form>
            <input type="text" id="nick" name="nick"><br><br>
            <button class="enter-button" type="button" onclick="showLobby()">Enter Lobby</button>
        </form>
    </div>

    <!-- <div class="lobby-overlay" id="lobby">
        <div class="lobby-content">
            <h1>TheWordSearchGame Lobby</h2>
                <button class="room-button" type="button" onclick="showReadyUp()">Room 1</button>
                <button class="room-button" type="button" onclick="showReadyUp()">Room 2</button>
                <button class="room-button" type="button" onclick="showReadyUp()">Room 3</button>
                <button class="room-button" type="button" onclick="showReadyUp()">Room 4</button>
                <button class="room-button" type="button" onclick="showReadyUp()">Room 5</button>
                <button class="room-button" type="button" onclick="showReadyUp()">Room 6</button>
        </div>

        <div class="button-container">
            <button class="back-button" type="button" onclick="backToHome()">Back</button>
            <button class="chat-button" type="button" onclick="openChatBox()">Chat</button>
        </div>

        <div class="leaderboard-container">
            <h2>TWSG Leaderboard:</h2>
            <p>Player 1</p>
            <p>Player 2</p>
            <p>Player 3</p>
            <p>Player 4</p>
            <p>Player N</p>
        </div>
    </div> -->
    <div class="lobby-overlay" id="lobby">
        <div class="leaderboard-container">
            <h2>TWSG Leaderboard</h2>
            <p>Player 1</p>
            <p>Player 2</p>
            <p>Player 3</p>
            <p>Player 4</p>
            <p>Player N</p>
        </div>
        <div class="lobby-content">
            <button class="back-button" type="button" onclick="backToHome()">Back</button>
            <h1>TheWordSearchGame Lobby</h1>
            <!-- <div class="leaderboard-container">
                <h2>TWSG Leaderboard:</h2>
                <p>Player 1</p>
                <p>Player 2</p>
                <p>Player 3</p>
                <p>Player 4</p>
                <p>Player N</p>
            </div> -->
            <button class="room-button" type="button" onclick="showReadyUp()">Room 1</button>
            <button class="room-button" type="button" onclick="showReadyUp()">Room 2</button>
            <button class="room-button" type="button" onclick="showReadyUp()">Room 3</button>
            <button class="room-button" type="button" onclick="showReadyUp()">Room 4</button>
            <button class="room-button" type="button" onclick="showReadyUp()">Room 5</button>
            <button class="room-button" type="button" onclick="showReadyUp()">Room 6</button>
        </div>

        <div class="chat-container">
            <h2><center>Chat</center></h2>
            <!-- <label for="msg">Select who you would like to message</label> -->
            <!-- <button class="contact-button" type="button">All Players</button> -->
        
            <!-- <p>Player 1: Hello everyone</p> -->
            <textarea placeholder="Your Message" name="msg" required></textarea>
            <button class="chat-button" type="button" onclick="sendMessage()">Send Message</button>
        </div>
    </div>
    

    <div class="readyup-overlay" id="readyup">
        <div class="readyup-content">
            <h1>Ready Up! 4 Players Required</h1>
            <button class="room-button" type="button" onclick="showGame()">Ready Player 1</button>
            <button class="room-button" type="button" onclick="showGame()">Ready Player 2</button>
            <button class="room-button" type="button" onclick="showGame()">Ready Player 3</button>
            <button class="room-button" type="button" onclick="showGame()">Ready Player 4</button>

            <button class="back-button" type="button" onclick="backToLobby()">Back</button>

        </div>
    </div>

    <div class="game-overlay" id="game">
        <div class="game-content">
            <h1>HappySearching!</h1>
            <button class="back-button" type="button" onclick="quitGame()">Quit Game</button>
        </div>
    </div>

    <script>
        var connection = null;

        var serverUrl;
        serverUrl = "ws://" + window.location.hostname + ":" + (parseInt(location.port) + 100);
        connection = new WebSocket(serverUrl); // this wobsocket is working now!

        connection.onopen = function (evt) {
            console.log("open");
        }

        connection.onclose = function (evt) {
            console.log("close");
            document.getElementById("topMessage").innerHTML = "Server Offline"
        }

        connection.onmessage = function (evt) {
            var msg = evt.data;
            console.log("Message received: " + msg);
            const obj = JSON.parse(msg);

            if ('WordGrid' in obj) {
                // Render the word grid
                renderWordGrid(obj.WordGrid);
            } else if ('Message' in obj) {
                document.getElementById("topMessage").innerHTML = obj.Message;
            }
        }

        function renderWordGrid(wordGrid) {
            var gridHtml = "<table>";
            for (var i = 0; i < wordGrid.length; i++) {
                gridHtml += "<tr>";
                for (var j = 0; j < wordGrid[i].length; j++) {
                    gridHtml += "<td><button id='b" + (i * wordGrid.length + j) + "' onclick='buttonClick(" + i + "," + j + ")'>" + wordGrid[i][j] + "</button></td>";
                }
                gridHtml += "</tr>";
            }
            gridHtml += "</table>";
            document.getElementById("wordGrid").innerHTML = gridHtml;
        }

        function buttonClick(row, col) {
            var position = { "row": row, "col": col };
            connection.send(JSON.stringify(position));
        }

        function showLobby() {
            document.querySelector(".content").style.display = "none";
            document.getElementById("lobby").style.display = "flex";
        }

        function backToHome() {
            document.querySelector(".content").style.display = "flex";
            document.getElementById("lobby").style.display = "none";
        }

        function showReadyUp() {
            document.getElementById("lobby").style.display = "none";
            document.getElementById("readyup").style.display = "flex";
        }

        function backToLobby() {
            document.getElementById("readyup").style.display = "none";
            document.getElementById("lobby").style.display = "flex";
        }

        function showGame() {
            document.getElementById("readyup").style.display = "none";
            document.getElementById("game").style.display = "flex";
        }

        function quitGame() {
            document.getElementById("game").style.display = "none";
            document.getElementById("readyup").style.display = "none";
            document.getElementById("lobby").style.display = "flex";
        }

        function sendMessage() {
            document.getElementById()
        }

    </script>
</body>

</html>